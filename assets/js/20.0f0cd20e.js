(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{444:function(a,s,t){"use strict";t.r(s);var e=t(29),n=Object(e.a)({},(function(){var a=this,s=a.$createElement,t=a._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h2",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[a._v("#")]),a._v(" 简介")]),a._v(" "),t("p",[a._v("lerna是GitHub上面开源的一款js代码库管理软件， 用来对一系列相互耦合比较大、又相互独立的js git库进行管理。")]),a._v(" "),t("h2",{attrs:{id:"基础"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基础"}},[a._v("#")]),a._v(" 基础")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[a._v("npm")]),a._v(" i -g lerna "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装")]),a._v("\nlerna init "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 一个目录下初始化")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("p",[a._v("安装之后目录")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("packages/ "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 保存多包的目录")]),a._v("\npackage.json\nlerna.json\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("h2",{attrs:{id:"管理模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#管理模式"}},[a._v("#")]),a._v(" 管理模式")]),a._v(" "),t("p",[a._v("使用lerna管理项目时，可以选择两种模式。")]),a._v(" "),t("h3",{attrs:{id:"固定模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#固定模式"}},[a._v("#")]),a._v(" 固定模式")]),a._v(" "),t("p",[a._v("默认的为固定模式(Fixed mode)，当使用lerna init命令初始化项目时，就默认为固定模式，也可以使用 lerna init --independent 命令初始化项目，这个时候就为独立模式(Independent mode)。\n固定模式中，packages下的所有包共用一个版本号(version)，会自动将所有的包绑定到一个版本号上(该版本号也就是lerna.json中的version字段)，所以任意一个包发生了更新，这个共用的版本号就会发生改变。")]),a._v(" "),t("h3",{attrs:{id:"独立模式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#独立模式"}},[a._v("#")]),a._v(" 独立模式")]),a._v(" "),t("p",[a._v("独立模式允许每一个包有一个独立的版本号，在使用lerna publish命令时，可以为每个包单独制定具体的操作，同时可以只更新某一个包的版本号。此种模式时，lerna.json中的version字段指定为"),t("code",[a._v("independent")]),a._v("即可。")]),a._v(" "),t("h2",{attrs:{id:"lerna-json解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-json解析"}},[a._v("#")]),a._v(" lerna.json解析")]),a._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"version"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"1.1.3"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"npmClient"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"npm"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"command"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"publish"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"ignoreChanges"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ignored-file"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"*.md"')]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"bootstrap"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"ignore"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"component-*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n      "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"npmClientArgs"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"--no-package-lock"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("      \n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[a._v('"packages"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[a._v('"packages/*"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br"),t("span",{staticClass:"line-number"},[a._v("7")]),t("br"),t("span",{staticClass:"line-number"},[a._v("8")]),t("br"),t("span",{staticClass:"line-number"},[a._v("9")]),t("br"),t("span",{staticClass:"line-number"},[a._v("10")]),t("br"),t("span",{staticClass:"line-number"},[a._v("11")]),t("br"),t("span",{staticClass:"line-number"},[a._v("12")]),t("br"),t("span",{staticClass:"line-number"},[a._v("13")]),t("br"),t("span",{staticClass:"line-number"},[a._v("14")]),t("br"),t("span",{staticClass:"line-number"},[a._v("15")]),t("br"),t("span",{staticClass:"line-number"},[a._v("16")]),t("br"),t("span",{staticClass:"line-number"},[a._v("17")]),t("br")])]),t("ul",[t("li",[a._v("version , 当前库的版本")]),a._v(" "),t("li",[a._v("npmClient , 允许指定命令使用的client， 默认是 npm， 可以设置成 yarn")]),a._v(" "),t("li",[a._v("command.publish.ignoreChanges ， 可以指定那些目录或者文件的变更不会被publish")]),a._v(" "),t("li",[a._v("command.bootstrap.ignore ， 指定不受 bootstrap 命令影响的包")]),a._v(" "),t("li",[a._v("command.bootstrap.npmClientArgs ， 指定默认传给 lerna bootstrap 命令的参数")]),a._v(" "),t("li",[a._v("command.bootstrap.scope ， 指定那些包会受 lerna bootstrap 命令影响")]),a._v(" "),t("li",[a._v("packages ， 指定包所在的目录")])]),a._v(" "),t("h2",{attrs:{id:"常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[a._v("#")]),a._v(" 常用命令")]),a._v(" "),t("h3",{attrs:{id:"lerna-publish"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-publish"}},[a._v("#")]),a._v(" lerna publish")]),a._v(" "),t("p",[a._v("发布新的库版本")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("lerna publish  "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 发布最新commit的修改")]),a._v("\nlerna publish "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("commit-id"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 发布指定commit-id的代码")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h3",{attrs:{id:"lerna-version"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-version"}},[a._v("#")]),a._v(" lerna version")]),a._v(" "),t("ul",[t("li",[a._v("识别出修改的包")]),a._v(" "),t("li",[a._v("创建新的版本号")]),a._v(" "),t("li",[a._v("修改package.json")]),a._v(" "),t("li",[a._v("提交修改 打上版本的tag")]),a._v(" "),t("li",[a._v("推送到git上")])]),a._v(" "),t("h3",{attrs:{id:"lerna-bootstrap"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-bootstrap"}},[a._v("#")]),a._v(" lerna bootstrap")]),a._v(" "),t("ul",[t("li",[a._v("为每个包安装依赖")]),a._v(" "),t("li",[a._v("链接相互依赖的库到具体的目录")]),a._v(" "),t("li",[a._v("执行 npm run prepublish")]),a._v(" "),t("li",[a._v("执行 npm run prepare")])]),a._v(" "),t("h3",{attrs:{id:"lerna-list"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-list"}},[a._v("#")]),a._v(" lerna list")]),a._v(" "),t("p",[a._v("列举当前lerna 库包含的包")]),a._v(" "),t("h3",{attrs:{id:"lerna-changed"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-changed"}},[a._v("#")]),a._v(" lerna changed")]),a._v(" "),t("p",[a._v("显示自上次relase tag以来有修改的包")]),a._v(" "),t("h3",{attrs:{id:"lerna-diff"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-diff"}},[a._v("#")]),a._v(" lerna diff")]),a._v(" "),t("p",[a._v("显示自上次relase tag以来有修改的包的差异， 执行 git diff")]),a._v(" "),t("h3",{attrs:{id:"lerna-exec"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-exec"}},[a._v("#")]),a._v(" lerna exec")]),a._v(" "),t("p",[a._v("在每个包目录下执行任意命令")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("lerna "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" -- "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("rm")]),a._v(" -rf ./node_modules "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 删除每个目录下的node_modules")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"lerna-run"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-run"}},[a._v("#")]),a._v(" lerna run")]),a._v(" "),t("p",[a._v("执行每个包package.json中的脚本命令")]),a._v(" "),t("h3",{attrs:{id:"lerna-init"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-init"}},[a._v("#")]),a._v(" lerna init")]),a._v(" "),t("p",[a._v("创建一个新的lerna库或者是更新lerna版本")]),a._v(" "),t("ul",[t("li",[a._v("修改package.json中lerna版本")]),a._v(" "),t("li",[a._v("创建lerna.json")])]),a._v(" "),t("h3",{attrs:{id:"lerna-add"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-add"}},[a._v("#")]),a._v(" lerna add")]),a._v(" "),t("p",[a._v("添加一个包的版本为各个包的依赖")]),a._v(" "),t("h3",{attrs:{id:"lerna-clean"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-clean"}},[a._v("#")]),a._v(" lerna clean")]),a._v(" "),t("p",[a._v("删除各个包下的node_modules")]),a._v(" "),t("h3",{attrs:{id:"lerna-import"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-import"}},[a._v("#")]),a._v(" lerna import")]),a._v(" "),t("p",[a._v("导入指定git仓库的包作为lerna管理的包")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("lerna "),t("span",{pre:!0,attrs:{class:"token function"}},[a._v("import")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("path-to-external-repository"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h3",{attrs:{id:"lerna-link"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-link"}},[a._v("#")]),a._v(" lerna link")]),a._v(" "),t("p",[a._v("链接互相引用的库")]),a._v(" "),t("h3",{attrs:{id:"lerna-create"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#lerna-create"}},[a._v("#")]),a._v(" lerna create")]),a._v(" "),t("p",[a._v("新建包")]),a._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[a._v("lerna create "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("<")]),a._v("name"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br")])]),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[a._v("#")]),a._v(" 参考")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/2f9c05b119c9",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.jianshu.com/p/2f9c05b119c9"),t("OutboundLink")],1)]),a._v(" "),t("p",[t("a",{attrs:{href:"https://www.jianshu.com/p/8b7e6025354b",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://www.jianshu.com/p/8b7e6025354b"),t("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);